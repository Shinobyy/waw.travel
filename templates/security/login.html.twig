{% extends 'base.html.twig' %}

{% block title %}Log in!{% endblock %}

{% block body %}
<div class="min-h-dvh bg-login bg-center bg-no-repeat bg-cover flex items-center justify-center
md:items-baseline md:justify-end md:h-screen">

    <div class="bg-white flex flex-col gap-8 w-full m-6 p-4 rounded-lg
    md:m-0 md:rounded-none md:w-1/2 md:h-full">
            
            <span class="hidden md:flex text-lg gap-2 flex-wrap md:ml-auto md:p-8"><p>Pas encore chez nous ?</p><a  class="underline" href={{ path('app_registration') }}>S'enregistrer</a></span>

            <div class="flex flex-col gap-2 md:mx-24">
                <h1 class="text-3xl">Connexion</h1>

                <span class="text-lg flex gap-2 flex-wrap md:hidden"><p>Pas encore chez nous ?</p><a  class="underline" href={{ path('app_registration') }}>S'enregistrer</a></span>
            </div>

            <form method="post" action="{{ path('app_login') }}" class="flex flex-col items-center gap-8 md:mx-24">
                {% if error %}
                    <div class="alert alert-danger">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
                {% endif %}

                {% if app.user %}
                    <div class="mb-3">
                        You are logged in as {{ app.user.userIdentifier }}, <a href="{{ path('app_logout') }}">Logout</a>
                    </div>
                {% endif %}

                <div class="flex flex-col gap-8 w-full">
                    <div class="flex flex-col gap-2">
                        <label for="inputEmail" class="text-secondary-black">Adresse email</label>
                        <input class="outline outline-1 outline-gray-300 rounded-md py-2 px-1" type="email" value="{{ last_username }}" name="_username" id="inputEmail" autocomplete="email" required autofocus>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex">
                            <label for="inputPassword" class="text-secondary-black">Mot de passe</label>
                            <div class="ml-auto flex gap-2 cursor-pointer" id="togglePassword">
                                <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye text-secondary-black"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/><circle cx="12" cy="12" r="3"/></svg>
                                <p id="show-password" class="select-none text-secondary-black">Afficher</p>
                            </div>
                        </div>
                        <input class="outline outline-1 outline-gray-300 rounded-md py-2 px-1" type="password" name="_password" id="inputPassword" autocomplete="current-password" required>
                    </div>
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

                    <div class="ml-auto">
                        <label>
                            <input type="checkbox" name="_remember_me"> Se souvenir de moi
                        </label>
                    </div>
                </div>

                <button class="submit-btn w-full rounded-full md:w-1/3 md:mr-auto" type="submit">
                    Se connecter
                </button>
            </form>

            <span class="text-lg flex gap-2 justify-center pb-8 md:mr-auto md:mx-24"><p>Pas encore chez nous ?</p><a  class="underline" href={{ path('app_registration') }}>S'enregistrer</a></span>

        </div>

    </div>
{% endblock %}

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const passwordInput = document.getElementById('inputPassword');
        const togglePassword = document.getElementById('togglePassword');
        let eyeIcon = document.getElementById('eyeIcon');
        let showPassword = document.getElementById('show-password');

        const eyeSvg = `<svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/><circle cx="12" cy="12" r="3"/></svg>`;

        const eyeOffSvg = `<svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-off"><path d="M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"/><path d="M14.084 14.158a3 3 0 0 1-4.242-4.242"/><path d="M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"/><path d="m2 2 20 20"/></svg>`;

        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            eyeIcon.innerHTML = type === 'password' ? eyeSvg : eyeOffSvg;
            showPassword.textContent = type === 'password' ? 'Afficher' : 'Masquer';
        });
    });
</script>
{% endblock %}
